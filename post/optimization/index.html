<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.7.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="陈煜">

  
  
  
    
  
  <meta name="description" content="1. 凸优化和非凸优化
凸优化问题的一般形式
$$
\min\quad f(x) \qquad\qquad\qquad\qquad \
s.t.\quad h_i(x) = 0, \forall i = 1,\cdots, n\
\qquad\quad g_j(x) &lt; 0, \forall j = 1, \cdots, m
\tag{1}
$$
其中 $f(x), g_j(x)$ 都是凸函数，$h_i(x)$ 为仿射函数(既是凸函数又是凹函数)。">

  
  <link rel="alternate" hreflang="en-us" href="https://AIBluefisher.github.io/post/optimization/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cutive+Mono%7CLora:400,700%7CRoboto:400,700&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hub80440ffaa830bbd6afb7f636b172ec1_202270_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hub80440ffaa830bbd6afb7f636b172ec1_202270_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://AIBluefisher.github.io/post/optimization/">

  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="AIBluefisher">
  <meta property="og:url" content="https://AIBluefisher.github.io/post/optimization/">
  <meta property="og:title" content="Robust Optimization in 3D Vision | AIBluefisher">
  <meta property="og:description" content="1. 凸优化和非凸优化
凸优化问题的一般形式
$$
\min\quad f(x) \qquad\qquad\qquad\qquad \
s.t.\quad h_i(x) = 0, \forall i = 1,\cdots, n\
\qquad\quad g_j(x) &lt; 0, \forall j = 1, \cdots, m
\tag{1}
$$
其中 $f(x), g_j(x)$ 都是凸函数，$h_i(x)$ 为仿射函数(既是凸函数又是凹函数)。"><meta property="og:image" content="img/map[gravatar:%!s(bool=false) shape:circle]">
  <meta property="twitter:image" content="img/map[gravatar:%!s(bool=false) shape:circle]"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-07-28T11:02:09&#43;08:00">
    
    <meta property="article:modified_time" content="2019-07-28T11:02:09&#43;08:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://AIBluefisher.github.io/post/optimization/"
  },
  "headline": "Robust Optimization in 3D Vision",
  
  "datePublished": "2019-07-28T11:02:09+08:00",
  "dateModified": "2019-07-28T11:02:09+08:00",
  
  "author": {
    "@type": "Person",
    "name": "陈煜"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "AIBluefisher",
    "logo": {
      "@type": "ImageObject",
      "url": "https://AIBluefisher.github.io/images/icon_hub80440ffaa830bbd6afb7f636b172ec1_202270_192x192_fill_lanczos_center_2.png"
    }
  },
  "description": "\u003ch2 id=\"1-凸优化和非凸优化\"\u003e1. 凸优化和非凸优化\u003c/h2\u003e\n\u003cp\u003e凸优化问题的一般形式\u003c/p\u003e\n\u003cp\u003e$$\n\\min\\quad f(x) \\qquad\\qquad\\qquad\\qquad \\\u003cbr\u003e\ns.t.\\quad h_i(x) = 0, \\forall i = 1,\\cdots, n\\\u003cbr\u003e\n\\qquad\\quad g_j(x) \u0026lt; 0, \\forall j = 1, \\cdots, m\n\\tag{1}\n$$\n其中 $f(x), g_j(x)$ 都是凸函数，$h_i(x)$ 为仿射函数(既是凸函数又是凹函数)。\u003c/p\u003e"
}
</script>

  

  


  


  





  <title>Robust Optimization in 3D Vision | AIBluefisher</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">AIBluefisher</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">AIBluefisher</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/CV.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Robust Optimization in 3D Vision</h1>

  

  
    


<div class="article-metadata">

  
  
  
  
  <div>
    



  
  <span><a href="/authors/%E9%99%88%E7%85%9C/">陈煜</a></span>

  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Jul 28, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    9 min read
  </span>
  

  
  
  

  
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      <h2 id="1-凸优化和非凸优化">1. 凸优化和非凸优化</h2>
<p>凸优化问题的一般形式</p>
<p>$$
\min\quad f(x) \qquad\qquad\qquad\qquad \<br>
s.t.\quad h_i(x) = 0, \forall i = 1,\cdots, n\<br>
\qquad\quad g_j(x) &lt; 0, \forall j = 1, \cdots, m
\tag{1}
$$
其中 $f(x), g_j(x)$ 都是凸函数，$h_i(x)$ 为仿射函数(既是凸函数又是凹函数)。</p>
<h3 id="11-凸函数">1.1 凸函数</h3>
<p>凸函数的定义:
对于定义在凸集上的函数$f$，如果对任意 $0 \leq \theta \leq 1$，都有</p>
<p>$$
f(\theta x + (1 - \theta) y) \leq \theta f(x) + (1 - \theta) f(y) \tag{2}
$$</p>
<p>一个简单的例子: 对于下图，函数任意两点之间的弦都在函数的上方。</p>
<div align=center> 
    <img src="/img/optimization/convex_function.png" />
</div>
<!-- 以及更高维空间中的凸函数

<div align=center>
    <img src="/img/optimization/3d_convex_function.jpg"/>
</div> -->
<p>但是实际中，要验证一个函数是否是凸函数，这个定义很不好用。因此，存在一些其他方法判断是否是凸函数。</p>
<h4 id="1-导数和二阶信息判断">(1) 导数和二阶信息判断</h4>
<p>对于一个光滑的函数(几乎处处可导)，可通过以下导数信息判断:</p>
<p>(一阶充要条件) $f(y) \geq f(x) + \nabla f(x)^T (y - x)$
(二阶充要条件) $\nabla^2 f(x) \geq 0$</p>
<h4 id="2-利用凸函数的结构叠加性质">(2) 利用凸函数的结构叠加性质</h4>
<p>另一类有用的方法就是可以利用凸函数的一些结构叠加性质来判断这些函数是否是凸函数复合而成。</p>
<ul>
<li>
<p>非负加权求和: $f(x) = \sum_i \alpha_if_i(x), \forall \alpha_i \geq 0$</p>
</li>
<li>
<p>仿射变换: $f(x) = f_i(Ax + b)$</p>
</li>
<li>
<p>取最大值: $f(x) = max{f_1(x), \cdots, f_m(x)}$</p>
</li>
<li>
<p>标量复合, 向量复合, 最小化 &hellip;</p>
</li>
</ul>
<h3 id="12-非凸函数">1.2 非凸函数</h3>
<p>凸函数(凹函数，拟凸函数)的一个对立就是非凸函数。凸函数的一个好处就是，对于优化得到的局部最优点，一定是一个全局最优点，因为凸函数只存在一个全局最优。而对于非凸函数，则存在非常多的局部最优点，还有非常多的鞍点。如下图所示:</p>
<div align=center>
    <img src="/img/optimization/non_convex_function.jpg"/>
</div>
<p>对于非凸优化问题，当优化算法收敛的时候，不利用其他信息，很难判断是否收敛到全局最优。因而非凸优化问题的求解要想尽可能的逼近全局最优，需要有较为可靠的初始值。很不幸的是，我们面临的大多数问题都是非凸优化问题。</p>
<h2 id="2-l_1-范数-vs-l_2-范数">2. $l_1$-范数 VS $l_2$-范数</h2>
<p>对于优化问题，我们通常想要最小化估计值 $f(x)$ 和目标值 $y$ 之间的残差(residual)</p>
<p>$$
\min d(y, f(x))^p　\tag{3}
$$</p>
<p>其中，$d(,)^p$ 表示误差度量的范数。对于向量来说，常见的有 $l_1$-范数、$l_2$-范数。
如果是 $l_1$-范数，残差是目标值和估计值之差的绝对值之和:</p>
<p>$$
S = \sum_{i=1}^n |y_i - f(x_i)| \tag{4}
$$</p>
<p>如果是 $l_2$-范数，残差是目标值和估计值之差的平方和:</p>
<p>$$
S = \sum_{i=1}^n (y_i - f(x_i))^2 \tag{5}
$$</p>
<p>那么 使用　$l_1$-范数做优化和 $l_2$-范数来做优化有什么区别呢？
我们知道，真实的观测数据通常存在外点 (outliers)。outlier的存在会导致优化时的最优点偏离真实的最优点。在外点存在的情况下，$l_1$-范数会比$l_2$-范数鲁棒。虽然这在理论上并没有严格的证明，不过从直观上来讲，由于 $l_2$-范数对误差进行了平方，因此相比 $l_1$-范数来说，外点会贡献更多的误差(如果 $e &gt; 1$, $e^2 &gt; e$)。而优化算法又需要最小化误差，因此会导致优化会更多地朝着外点的方向去调整。</p>
<p>这两种范数度量之间的比较:</p>
<ul>
<li>$l_1$-范数比 $l_2$-范数更鲁棒</li>
<li>$l_2$-范数比 $l_1$-范数更稳定</li>
</ul>
<h2 id="3-最小二乘法">3. 最小二乘法</h2>
<h3 id="31-最小二乘问题">3.1 最小二乘问题</h3>
<p>最小二乘问题的定义是</p>
<p>$$
\min f(x) = \frac{1}{2} \sum_{i=1}^m r_i^2(x) = \frac{1}{2}r(x)^Tr(x), x \in \mathbb{R}^n, m \geq n \tag{6}
$$</p>
<p>这里 $r(x) = [r_1(x), r_2(x), \cdots, r_m(x)]^T$ 称作剩余函数(残差）。若 $r_i(x)$ 均为线性函数，则问题为<code>线性最小二乘问题</code>；若至少有一个 $r_i(x)$ 为非线性函数，则问题为<code>非线性最小二乘问题</code>。</p>
<p>下面我们来看最小二乘问题的目标函数 $f(x)$ 的一、二阶导数的形式。设 $J(x)$ 是 $r(x)$ 的 Jacobi 矩阵:</p>
<p>$$
J(x) = [\nabla r_1(x), \cdots, \nabla r_m(x)]^T \in \mathbb{R}^{m \times n}
$$</p>
<p>则 $f(x)$ 的梯度为</p>
<p>$$
g(x) = \sum_{i=1}^m r_i(x) \nabla r_i(x) = J(x)^T r(x) \tag{7}
$$</p>
<p>$f(x)$ 的 Hessian 矩阵为</p>
<p>$$
G(x) = \sum_{i=1}^m \nabla r_i(x) \nabla r_i(x)^T + \sum_{i=1}^m r_i(x)\nabla^2 r_i(x) = J(x)^T J(x) + S(x) \tag{8}
$$</p>
<p>其中，$S(x) = \sum_{i=1}^m r_i(x) \nabla^2 r_i(x)$。</p>
<h3 id="32-最小二乘的来源">3.2 最小二乘的来源</h3>
<p>最小二乘问题大量产生于数据拟合问题: 给定一组实验数据 $(x_i, y_i)$ 和函数模型 $f(x)$，要确定 $x$，使得 $f(x)$ 在残差的平方和意义下尽可能地拟合给定的数据。即</p>
<p>$$
\arg\min_x \sum_{i=1}^n ||y_i - f(x_i)||_2^2 \tag{9}
$$</p>
<p>最小二乘问题和极大似然估计之间存在联系。我们通常假定误差遵循高斯(正态)分布。具体来讲，我们假定目标值和观测值之间都具有零均值和标准差为 $\sigma$ 的高斯噪声。若真值为 $y_i$，估计值为 $f(x_i)$，那么每个估计值的概率密度函数是</p>
<p>$$
Pr(x_i) = \frac{1}{2\pi \sigma^2} e^{-\frac{(y_i - f(x_i))^2}{2\sigma^2}} \tag{10}
$$</p>
<p>假设误差独立同分布，那么联合概率密度函数为</p>
<p>$$
Pr(x) = \prod_i Pr(x_i) = \prod_i \frac{1}{2\pi \sigma^2} e^{-\frac{(y_i - f(x_i))^2}{2\sigma^2}} \tag{11}
$$</p>
<p>对应的对数似然函数为:</p>
<p>$$
log Pr(x) = -\frac{1}{2\pi \sigma^2} \sum_i (y_i - f(x_i))^2 + c \tag{12}
$$</p>
<p>最大似然估计最大化这个对数似然函数，也即最小化</p>
<p>$$
\sum_i (y_i - f(x_i))^2 \Leftrightarrow \sum_i ||y_i - f(x_i)||_2^2 \tag{13}
$$</p>
<h3 id="33-鲁棒最小二乘和迭代重加权irls-问题">3.3 鲁棒最小二乘和迭代重加权(IRLS) 问题</h3>
<p>常规的最小二乘对其中噪声符合高斯分布的观测值来说是一个合适的选择，然而在存在外点的时，需要更鲁棒的最小二乘。这种情况下，最好用M-估计(M-estimator)，它对残差施加一个鲁棒惩罚函数 $\rho (r) $ (也称为 <code>loss function</code>)
$$
E_{RLS(\triangle \boldsymbol{x})} = \sum_{i} \rho(||\boldsymbol{r}_i||) \tag{14}
$$
来代替它们的平方</p>
<p>$$
E_{LS(\triangle \boldsymbol{x})} = \sum_{i} ||\boldsymbol{r}_i||_2^2 \tag{15}
$$</p>
<p>其中 $\boldsymbol{r}_i = y_i - f(x_i)$ 。公式(14)对$\boldsymbol{x}$求偏导，则有</p>
<p>$$
\sum_{i} \frac{\partial \rho (||\boldsymbol{r}_i||)}{\partial ||\boldsymbol{r_i}||} \cdot\frac{\partial ||\boldsymbol{r}_i||}{\partial \boldsymbol{x}}\<br>
= \sum_i \frac{\partial \rho (||\boldsymbol{r}_i||)}{\partial ||\boldsymbol{r_i}|| \cdot ||\boldsymbol{r}_i||} \cdot \boldsymbol{r}_i^T \frac{\partial ||\boldsymbol{r}_i||}{\partial \boldsymbol{x}}\<br>
= \sum_i \frac{\Psi (||\boldsymbol{r}_i||)}{||\boldsymbol{r}_i||} \cdot \boldsymbol{r}_i^T \frac{\partial ||\boldsymbol{r}_i||}{\partial \boldsymbol{x}} \ \ \ \ \ \ \ \<br>
= \sum_i w(||\boldsymbol{r}_i||) \cdot \boldsymbol{r}_i^T \frac{\partial ||\boldsymbol{r}_i||}{\partial \boldsymbol{x}} = 0 \ \ \tag{16}
$$</p>
<p>其中 $\Psi (||\boldsymbol{r}_i||) = \frac{\partial \rho (||\boldsymbol{r}_i||)}{\partial ||\boldsymbol{r_i}||}$，称为<code>影响函数 (influence function)</code>，$w(r) = \frac{\Psi(r)}{r}$ 称为<code>加权函数(weight function)</code>。可以看出用公式(12)求解 (10)的极小值等于最小化<code>迭代重加权最小二乘 (Iteratively Reweighted Least Squares, IRLS)问题</code></p>
<p>$$
E_{IRLS} = \sum_i w(||\boldsymbol{r}_i||)||\boldsymbol{r}_i||^2 \tag{17}
$$</p>
<p>其中 $w(||\boldsymbol{r}_i||)$ 起着局部加权作用。IRLS 算法在计算影响函数 $w(||\boldsymbol{r}_i||)$ 和求解得到的加权最小二乘问题(固定的 $w$ 值) 之间交替。M-estimator 一定能够减少外点的影响，但是在一些情况中，从太多外点起步的话会使得 IRLS(或者其他梯度下降算法) 不能收敛到全局最优。</p>
<h2 id="4-优化问题在三维视觉中的应用">4. 优化问题在三维视觉中的应用</h2>
<h3 id="41-rotation-averaging">4.1 Rotation Averaging</h3>
<h4 id="411-相对运动和全局姿态的约束关系">4.1.1 相对运动和全局姿态的约束关系</h4>
<p>Rotation Averaging 是 Structure from Motion (SfM) 的一个子问题，现在在SLAM方面也有应用。无论是SfM还是SLAM，都需要估计摄像机的姿态 (pose)，摄像机的姿态由旋转 (rotation，或是朝向 orientation) 和平移 (translation，也可以说是摄像机位置)构成。</p>
<p>问题描述为: 给定 $N$ 张图片，全局运动可以用 $N-1$ 个运动模型描述。两个相机之间的相对运动关系可以通过对极几何估计<code>本质矩阵(Essential Matrix)</code>，再进行矩阵分解(对本质矩阵的奇异值分解)得到。我们可以通过相对相机运动来估计全局相机运动模型。如果每对图片之间都有足够的重叠，那么我们可以得到 $\frac{N(N-1)}{2}$ 对约束(虽然实际上不可能存在这么多对，但一般也存在远多于 $N$ 的约束)。</p>
<p>为了求解 RA 问题，首先来推几个公式。假设已知两个相机在全局坐标系下的运动，那么这两个相机之间的相对运动是怎样的关系呢？</p>
<p>已知点 $P$ 在世界坐标系中的坐标，记为 $P_0$。对于两个不同的相机 $i$ 和 $j$，对应于全局坐标系中的旋转和平移分别为 $R_i, t_i, R_j, t_j$ 。将点 $P_0$ 分别投影到相机 $i$ 和 $j$ 的坐标系，那么有</p>
<p>$$
P_i = R_iP_0 + t_j\ (18.a) \
P_j = R_jP_0 + t_j\ (18.b)
$$</p>
<p>由公式(18.a)我们可以得到</p>
<p>$$P_0 = R_i^{-1}(P_i - t_i)\ \tag{18} $$</p>
<p>将公式(19)代入(18.b)中，有
$$
P_j = R_j(R_i^{-1}(P_i - t_i)) + t_j\<br>
\ = R_jR_i^{-1}P_i + (t_j - R_jR_i^{-1}t_i)\ \tag{20}
$$
由公式(19)我们可以得到相机 $i$ 到相机 $j$ 的相对运动关系:
$$
R_{ij} = R_jR_i^{-1} = R_jR_i^{T}\ (21.a)\<br>
t_{ij} = t_j - R_jR_i^{-1}t_i = t_j - R_{ij}t_i\ (21.b)
$$
这里需要注意的是 ***$R_{ij}$ 和 $t_{ij}$是相机 $i$ 相对于 $j$ 的运动*** 。</p>
<h4 id="412-ra-问题的优化求解">4.1.2 RA 问题的优化求解</h4>
<p>给定参考系和一系列相对旋转 ${R_{ij}}$，我们希望求解 $R_{global} = {R_1, \cdots, R_N}$。我们希望最小化代价函数:
$$
\arg\min_{R_i} \sum_{(i,j)\in \mathcal{E}} d^2(R_{ij}, R_jR_i^{-1}) \tag{22}
$$
现在我们考虑使用李代数来进行优化, $R_{ij} = exp([\boldsymbol{w_{ij}}]_{\times}), R_i = exp([\boldsymbol{w_{i}}]_{\times})$，其中 $\boldsymbol{w_{ij}}$ 和 $\boldsymbol{w_{i}}$ 分别为 $R_{ij}$ 和 $R_i$ 对应的李代数。</p>
<p>假设只考虑其中一对关系 $R_{ij} = R_jR_i^{-1}$。由 BCH 公式： $BCH(x, y) = x + y + \frac{1}{2}[x, y] + \frac{1}{12}[x - y, [x, y]] + o(|(x, y)|^4)$，若只采用BCH公式的一阶估计 $BCH(x, y) \approx x + y$，则</p>
<p>$$
\boldsymbol{w_{ij}} = BCH(\boldsymbol{w_{j}}, -\boldsymbol{w_{i}}) = \boldsymbol{w_{j}} - \boldsymbol{w_{i}}
$$</p>
<p>令全局坐标系下旋转的李代数表示为 $\boldsymbol{\omega}_{global} = [\boldsymbol{\omega}_1, \cdots, \boldsymbol{\omega}_N]^T$，那么我们有</p>
<p>$$
\boldsymbol{w_{ij}} = \boldsymbol{w_{j}} - \boldsymbol{w_{i}} =
\left[
\begin{array}{cccc}
\cdots &amp; -I &amp; \cdots &amp; I &amp; \cdots
\end{array}
\right]
\boldsymbol{w_{global}}
= A_{ij}\boldsymbol{w_{global}} \tag{23}
$$</p>
<p>在 $A_{ij}$ 中，$I$ 和 $_I$ 为在 $i$ 和 $j$ 处的 $3\times 3$ 的块矩阵。把所有的相对运动关系拼合起来，我们有
$$
A\boldsymbol{w_{global}} = \boldsymbol{w_{rel}} \tag{24}
$$</p>
<p>现在，我们要做的就是如何求解这个非齐次线性方程组了。</p>
<h5 id="1-l_1-rotation-averaging">(1) $l_1$ Rotation Averaging</h5>
<p>考虑非齐次线性方程组 $A\boldsymbol{x} = \boldsymbol{b}$，其中 $\boldsymbol{x} \in \mathbb{R}^n, \boldsymbol{b} \in \mathbb{R}^m$，并且 $m &gt; n$。这个方程的求解难度由于噪声和外点的存在发生了改变，比如 $\boldsymbol{b} = A\boldsymbol{x} + \boldsymbol{e} $。在压缩感知方向的一些研究表明，在外点存在的情况下，$\boldsymbol{x}$ 可以通过以下公式高效精确地求解:</p>
<p>$$
\arg\min_x ||A\boldsymbol{x} - \boldsymbol{b}||_{l_1} \tag{25}
$$</p>
<h5 id="2-irls-rotation-averaging">(2) IRLS Rotation Averaging</h5>
<p>$l_1$优化得到的结果还能进一步提升。现在考虑使用 IRLS 算法来求解 Rotation Averaging 问题，令残差为 $\boldsymbol{e} = A\boldsymbol{x} - \boldsymbol{b}$，我们希望最小化鲁棒代价函数</p>
<p>$$
E_{RLS} = \sum_i \rho(||\boldsymbol{e}_i||) \tag{26}
$$</p>
<p>这里，loss function 选则 Huber-like loss function: $\rho(x) = \frac{x^2}{x^2 + \sigma^2}$。因此，</p>
<p>$$
min\ E_{RLS} = min\ \sum_i \rho(||\boldsymbol{e}_i||) = min\ \sum_i \frac{\boldsymbol{e}_i^2}{\boldsymbol{e}_i^2 + \sigma^2} \tag{27}
$$</p>
<p>公式(27)对 $\boldsymbol{x}$ 求偏导，有</p>
<p>$$
\frac{\partial E_{RLS}}{\partial \boldsymbol{x}} = \frac{\partial E_{RLS}}{\partial \boldsymbol{e}} \cdot \frac{\partial \boldsymbol{e}}{\partial \boldsymbol{x}} \qquad \qquad \qquad \qquad \ \<br>
= \frac{2||\boldsymbol{e}_i||(||\boldsymbol{e}_i||^2 + \sigma^2) - 2||\boldsymbol{e}_i||\cdot ||\boldsymbol{e}_i||^2}{(||\boldsymbol{e}_i||^2 + \sigma^2)^2} \cdot A^T\<br>
= \frac{2||\boldsymbol{e}_i||\sigma^2}{(||\boldsymbol{e}_i||^2 + \sigma^2)^2} \cdot A^T \qquad \qquad \qquad \qquad \quad \<br>
= \frac{2(A\boldsymbol{x}-b)\sigma^2 A^T}{(||\boldsymbol{e}_i||^2 + \sigma^2)^2} \qquad \qquad \qquad \qquad \qquad \<br>
= 2 \cdot \frac{A^T \sigma^2A\boldsymbol{x}- A^T\sigma^2b}{(||\boldsymbol{e}_i||^2 + \sigma^2)^2} = 0 \qquad \qquad \qquad\  \tag{28}
$$</p>
<p>因此，有</p>
<p>$$
A^T\Phi(\boldsymbol{e})A\boldsymbol{x} - A^T\Phi(\boldsymbol{e}) \boldsymbol{b} = 0\ \Rightarrow \<br>
A^T\Phi(\boldsymbol{e})A\boldsymbol{x} = A^T\Phi(\boldsymbol{e}) \boldsymbol{b} \tag{29}
$$</p>
<p>其中，$\Phi(\boldsymbol{e})$ 是对角阵并且 $\Phi(i, i) = \frac{\sigma^2}{(\boldsymbol{e}_i^2 + \sigma^2)^2}$ 。</p>
<p>由公式 (17), RLS 问题可以转变为求解 IRLS 问题： $min\ (A\boldsymbol{x} - \boldsymbol{b})^T\Phi(A\boldsymbol{x} - \boldsymbol{b})$，由公式 (29) 知，其最优点为</p>
<p>$$\boldsymbol{x} = (A^T \Phi A)^{-1} A^T \Phi \boldsymbol{b} \tag{30}$$</p>
<p>在 IRLS 中，我们先固定$\boldsymbol{x}$，然后计算 $\Phi$；接着固定 $\Phi$ (由公式 (30) 计算得到)。通过这样一个交替的方式直到收敛。</p>
<p>如果没有一个好的初值的话，<code>IRLS</code> 算法很有可能不能收敛到全局最优，而由于 <code>L1RA</code> 算法对于 $R_{gobal}$ 来说足够提供一个好的初值，因此 <code>L1RA</code> 算法的输出可以作为 <code>IRLS</code> 算法的输入。到这里，我们可以直到，整个使用 $l_1$-范数求解 Rotion Averaging 问题的算法(L1-IRLS)可以分为两步: (1) <code>L1RA</code>算法求解 $R_{global}$ 的初值；（2）$R_{global}$ 的初值作为 <code>IRLS</code> 的输入，使用算法2求解得到最终的 $R_{global}$ 。</p>
<h3 id="42-光束平差法-bundle-adjustment">4.2 光束平差法 (Bundle Adjustment)</h3>
<h4 id="421-相机投影模型">4.2.1 相机投影模型</h4>
<p>为了理解 Bundle Adjustment，首先需要了解空间中的三维点重投影回图像平面的过程。如下图所示，$p$ 是空间中的三维点，$o-xyz$ 是相机坐标系，$o‘-x’y‘$ 是成像平面，成像平面内的蓝色区域是像素平面(图像平面)，$f$ 是焦距。对于世界坐标系中的三维点，首先要通过相机在世界坐标系中的旋转和平移变换到相机坐标系 ($x = RX + t$)，进行归一化后，对归一化后的点进行去畸变，最后通过内参矩阵 $K$ 投影到图像平面。这一过程通过函数 $\pi(C_j, X_i)$ 描述。</p>
<div align=center>
    <img src="/img/optimization/pinhole_camera_model1.jpg"/>
</div>
<h4 id="422-ba-求解">4.2.2 BA 求解</h4>
<p>BA 最小化重投影误差</p>
<p>$$
min\ \sum_{i=1}^{n} \sum_{j=1}^m ||u_{ij} - \pi(C_j, X_i)||_2^2 \tag{31}
$$</p>
<p>其中 $n$ 为三维点的个数，$m$ 为相机个数。</p>
<div align="center">
    <img src="/img/optimization/bundle_adjustment1.jpg" />
</div>
<p>令残差 $r_{ij} = u_{ij} - \pi(C_j, X_i)$，公式 (31) 可重写为</p>
<p>$$
\min\ r^Tr \tag{32}
$$</p>
<p>对 $r$ 进行泰勒展开</p>
<p>$$
r(x + \delta x) = r(x) + g^T \delta x + \frac{1}{2}\delta x^T H \delta x + o(||\delta x||^2)\tag{33}
$$</p>
<p>(33) 右边对 $\delta x$ 求导，并令其等于０，可以得到</p>
<p>$$
H\delta x = -g \tag{34}
$$</p>
<p>公式 (34) 其实就是<code>牛顿方程 (Newton Equation)</code>。对于最小二乘问题来说， $H = J^T J + S, g = J^Tr$，其中 $S = \sum_{i=1}^n \sum_{j=1}^m r_{ij}\nabla^2 r_{ij}$。如果残差足够小，那么我们可以忽略 $S$。这个时候我们就可以得到高斯牛顿  (Gauss-Newton) 方程</p>
<p>$$
J^TJ \delta x = -J^Tr \tag{35}
$$</p>
<p>由 (35) 可知，当 $J$ 满秩，$g$ 不为0 的时候，$\delta x$ 一定是下降方向，因为 $(\delta x)^T g = (\delta x)^T J^T r = -(\delta x)^T J^T J \delta x = -||J \delta x||^2 &lt; 0$。但是当 $J^TJ$ 奇异的时候，高斯牛顿法在数值上会变得不稳定。这个时候，我们可以用 Levenberg-Marquardt 方法来代替</p>
<p>$$
(J^TJ + \lambda I)\delta x = -J^T r \tag{36}
$$</p>
<p>对于 Bundle Adjustment 问题，似乎我们只需要用线性代数的知识，就能够很容易地求解 (35) 和 (36) 了。但事实上真的是这样吗？</p>
<p>在三维重建中，我们可能需要优化非常多的相机和三维点，SfM 里优化几千个相机以及几百万甚至上千万个三维点的情形不在少数。这种情况下，Jacobian 矩阵的存储就是一大问题，除此之外，解这么大的一个方程组也会变得非常耗时。有没有什么方法能够让求解变得更快呢？我们先来分析分析Jocobian矩阵的结构。</p>
<p>令 $\hat{u}_{ij} = \pi(C_j, X_i)$，其中需要优化的变量 $x$ 由相机参数 $C_j$ 和 三维点 $X_i$ 组成，因此我们把 $x$ 分成相机参数块 $c$ 和三维结构参数块 $p$</p>
<p>$$
x = [c\ p] \tag{37}
$$</p>
<p>由于</p>
<p>$$
J_{ij} = \frac{\partial r_{ij}}{\partial x_k} = \frac{\partial \hat{u}_{ij}}{\partial x_k}
$$</p>
<p>我们很容易发现:</p>
<p>$$
\frac{\partial \hat{u}<em>{ij}}{\partial c_k} = 0, \forall j \neq k, \frac{\partial \hat{u}</em>{ij}}{\partial p_k} = 0, \forall i \neq k
$$</p>
<p>为了方便起见，现在我们考虑上图只有3个相机和4个三维点的情况，其中每个相机都能观测到这4个三维点。令 $A_{ij} = \frac{\partial \hat{u}_{ij}}{\partial c_j}, B_{ij} = \frac{\partial \hat{u}_{ij}}{\partial p_j}$，我们可以求得 Jacobian 矩阵:</p>
<p>$$
J =
\left[
\begin{array}{ccccccc}
A_{11} &amp; 0 &amp; 0 &amp; B_{11} &amp; 0 &amp; 0 &amp; 0\<br>
0 &amp; A_{12} &amp; 0 &amp; B_{12} &amp; 0 &amp; 0 &amp; 0\<br>
0 &amp; 0 &amp; A_{13} &amp; B_{13} &amp; 0 &amp; 0 &amp; 0\<br>
A_{21} &amp; 0 &amp; 0 &amp; 0 &amp; B_{21} &amp; 0 &amp; 0\<br>
0 &amp; A_{22} &amp; 0 &amp; 0 &amp; B_{22} &amp; 0 &amp; 0\<br>
0 &amp; 0 &amp; A_{23} &amp; 0 &amp; B_{23} &amp; 0 &amp; 0\<br>
A_{31} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; B_{31} &amp; 0\<br>
0 &amp; A_{32} &amp; 0 &amp; 0 &amp; 0 &amp; B_{32} &amp; 0\<br>
0 &amp; 0 &amp; A_{33} &amp; 0 &amp; 0 &amp; B_{33} &amp; 0\<br>
A_{41} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; B_{41}\<br>
0 &amp; A_{42} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; B_{42}\<br>
0 &amp; 0 &amp; A_{43} &amp; 0 &amp; 0 &amp; 0 &amp; B_{43}
\end{array}
\right] \tag{38}
$$</p>
<p>现在我们可以发现，BA 中的 Jacobian 是一个稀疏的矩阵，它包含了大量的零元素。那么，对于高斯牛顿方程和LM方法里的 $J^TJ$，我们也不难发现它的稀疏性。令</p>
<p>$$
U_j = \sum_{i=1}^4 A_{ij}^T A_{ij}, V_i = \sum_{j=1} B_{ij}^T B_{ij}, W_{ij} = A_{ij}^T B_{ij} \tag{39}
$$</p>
<p>$$
J^T J =
\left[
\begin{array}{ccccccc}
U_1 &amp; 0 &amp; 0 &amp; W_{11} &amp; W_{21} &amp; W_{31} &amp; W_{41}\<br>
0 &amp; U_2 &amp; 0 &amp; W_{12} &amp; W_{22} &amp; W_{32} &amp; W_{42}\<br>
0 &amp; 0 &amp; U_3 &amp; W_{13} &amp; W_{23} &amp; W_{33} &amp; W_{43}\<br>
W_{11}^T &amp; W_{12}^T &amp; W_{13}^T &amp; V_1 &amp; 0 &amp; 0 &amp; 0\<br>
W_{21}^T &amp; W_{22}^T &amp; W_{23}^T &amp; 0 &amp; V_2 &amp; 0 &amp; 0\<br>
W_{31}^T &amp; W_{32}^T &amp; W_{33}^T &amp; 0 &amp; 0 &amp; V_3 &amp; 0\<br>
W_{41}^T &amp; W_{42}^T &amp; W_{43}^T &amp; 0 &amp; 0 &amp; 0 &amp; V_4
\end{array}
\right]
\tag{40}
$$</p>
<p>现在，我们可以看到 Ba 中 Hessian 的近似 $J^TJ$ 也是一个稀疏的矩阵。对于更大规模的情况，Hessian的稀疏性如下图所示(注意这张图里的相机和三维点的顺序不一样):</p>
<div align="center">
    <img src = "/img/optimization/hessian.png" />
</div>
<p>对于 (36) 的右边，有</p>
<p>$$
J^T r =
\left(
\begin{array}{c}
\sum_{i=1}^4(A_{i1}^T r_{i1})\<br>
\sum_{i=1}^4(A_{i2}^T r_{i2})\
\sum_{i=1}^4(A_{i3}^T r_{i3})\
\sum_{j=1}^3 (B_{ij}^T r_{ij})\
\sum_{j=1}^3 (B_{ij}^T r_{2j})\
\sum_{j=1}^3 (B_{ij}^T r_{3j})\
\sum_{j=1}^3 (B_{ij}^T r_{4j})
\end{array}
\right)
\tag{41}
$$</p>
<p>令</p>
<p>$$
r_{c_j} = \sum_{i=1}^4(A_{ij}^T r_{ij})^T, r_{p_i} = \sum_{j=1}^3(B_{ij}^T r_{ij})^T,
r_{ij} = u_{ij} - \hat{u_{ij}}
\tag{42}
$$</p>
<p>并且</p>
<p>$$
U = diag{U_1, U_2, U_3},
V = diag{V_1, V_2, V_3, V_4},
\tag{43}
$$</p>
<p>$$
W = \left[
\begin{array}{cccc}
W_{11} &amp; W_{21} &amp; W_{31} &amp; W_{41} \<br>
W_{12} &amp; W_{22} &amp; W_{32} &amp; W_{42} \<br>
W_{13} &amp; W_{23} &amp; W_{33} &amp; W_{43}
\end{array}
\right]
\tag{44}
$$</p>
<p>我们把 (42)、(43)、(44) 代入 (35) 中，并且令 $\delta x = (\delta c\ \delta p)^T$，可以得到</p>
<p>$$
\left[
\begin{array}{cc}
U &amp; W  \<br>
W^T &amp; V
\end{array}
\right]
\left[
\begin{array}{c}
\delta c \<br>
\delta p
\end{array}
\right] =
\left[
\begin{array}{c}
r_c \<br>
r_p
\end{array}
\right]
\tag{45}
$$</p>
<p>现在，直接求解(45)在时间和空间上肯定是不可行的。注意到，(45) 中 $U, \delta c$ 是和相机相关的参数，$V,\delta p$ 是和三维点相关的参数，实际中的相机数远小于三维点的数量。因此，我们可以考虑先消去和三维点相关的参数，求得相机之后再代回求解三维点。现在，我们对 (45) 的左右两边同乘 $[I -WV^{-1}]^T$，可以得到</p>
<p>$$
\left[
\begin{array}{cc}
U-WV^{-1}W^T &amp; 0
\end{array}
\right]
\left[
\begin{array}{c}
\delta c \<br>
\delta p
\end{array}
\right] =
\left[
\begin{array}{cc}
I &amp; -WV^{-1}  \<br>
\end{array}
\right]
\left[
\begin{array}{c}
r_c \<br>
r_p
\end{array}
\right]
\tag{46}
$$
进一步我们可以得到
$$
(U - WV^{-1}W^T)\delta c = r_c - WV^{-1}r_p \tag{47}
$$</p>
<p>BA中，(47) 称作<code>Reduced Camera System</code>，$S = U - WV^{-1}W^T$ 称作 $V$ 的 <code>Schur Complement</code> 。可以证明，对称正定矩阵的 Schur Complement 是一个对称正定矩阵。因此，(47) 可以通过<code>乔里斯基分解 (Cholesky Decomposition)</code> 进行求解。由 (46)，我们有</p>
<p>$$
W^T\delta c + V\delta p = r_c \tag{48}
$$</p>
<p>在求解得到相机之后，由 (48)，我们有</p>
<p>$$
\delta p = V^{-1}(r_p - W^T\delta c) \tag{49}
$$</p>
<p>到这里，BA 的求解基本上可以结束了。不过，为了加速BA，还有一些求解技巧，像 <code>Preconditioned Conjugate Gradient</code>。对这些感兴趣的可以参考相关文献 [6,7,8]。</p>
<h2 id="参考文献">参考文献</h2>
<p>[1] Boyd. Convex Optimization.</p>
<p>[2] Govindu V M . Combining two-view constraints for motion estimation[C]// Computer Vision and Pattern Recognition, 2001. CVPR 2001. Proceedings of the 2001 IEEE Computer Society Conference on. IEEE, 2001.</p>
<p>[3] Govindu V M . Lie-Algebraic Averaging for Globally Consistent Motion Estimation[C]// null. IEEE Computer Society, 2004.</p>
<p>[4] Chatterjee A , Govindu V M . Efficient and Robust Large-Scale Rotation Averaging[C]// 2013 IEEE International Conference on Computer Vision (ICCV). IEEE Computer Society, 2013.</p>
<p>[5] Chatterjee A, Govindu V. Robust Relative Rotation Averaging[J]. IEEE Transactions on Pattern Analysis &amp; Machine Intelligence, 2017, PP(99):1-1.</p>
<p>[6] Lourakis M I A, Argyros A A. SBA: a software package for generic sparse bundle adjustment[J]. Acm Trans.math.softw, 2009, 36(1):2.</p>
<p>[7] Triggs B, Mclauchlan P F, Hartley R I, et al. Bundle Adjustment — A Modern Synthesis[C]// International Workshop on Vision Algorithms: Theory and Practice. Springer-Verlag, 1999:298-372.</p>
<p>[8] Jeong Y, Nistér D, Steedly D, et al. Pushing the envelope of modern methods for bundle adjustment.[J]. IEEE Trans Pattern Anal Mach Intell, 2012, 34(8):1605-1617.</p>
    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/optimization/">optimization</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://AIBluefisher.github.io/post/optimization/&amp;text=Robust%20Optimization%20in%203D%20Vision" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://AIBluefisher.github.io/post/optimization/&amp;t=Robust%20Optimization%20in%203D%20Vision" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Robust%20Optimization%20in%203D%20Vision&amp;body=https://AIBluefisher.github.io/post/optimization/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://AIBluefisher.github.io/post/optimization/&amp;title=Robust%20Optimization%20in%203D%20Vision" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Robust%20Optimization%20in%203D%20Vision%20https://AIBluefisher.github.io/post/optimization/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://AIBluefisher.github.io/post/optimization/&amp;title=Robust%20Optimization%20in%203D%20Vision" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  
  
    
  
  






  
  
  
  
  
  <div class="media author-card content-widget-hr">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/authors/%E9%99%88%E7%85%9C/"></a></h5>
      
      
      <ul class="network-icon" aria-hidden="true">
  
</ul>

    </div>
  </div>









  
  



  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.a8d7005002cb4a052fd6d721e83df9ba.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    2020 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
